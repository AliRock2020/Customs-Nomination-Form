<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل بيانات المتقدم</title>

<style>
body{
  margin:0;
  font-family:Tahoma, Arial;
  background:#f4f6f8;
}

h2{
  background:#eee;
  padding:10px;
  margin-top:30px;
}
.form-row{
  display:flex;
  gap:15px;
  margin-bottom:15px;
}
.form-row input,
.form-row select{
  flex:1;
  padding:12px;
  font-size:14px;
}
.course-row{
  border:1px solid #ccc;
  padding:15px;
  margin-bottom:15px;
  background:#fafafa;
}
.course-line{
  display:flex;
  gap:15px;
  margin-bottom:10px;
}
.course-line input{flex:1;padding:12px;}
.add-course{
  padding:10px;
  border:1px dashed #999;
  background:#eee;
  cursor:pointer;
}
.remove-course{
  background:#c0392b;
  color:#fff;
  border:none;
  padding:5px 10px;
  cursor:pointer;
}
.submit-btn{
  width:100%;
  padding:15px;
  background:#0066cc;
  color:#fff;
  border:none;
  font-size:16px;
}
#messageBox{
  margin-top:15px;
  padding:12px;
  border-radius:6px;
}
.success{background:#d4edda;color:#155724}
.error{background:#f8d7da;color:#721c24}
.hidden{display:none}

@media(max-width:768px){
  .form-row,.course-line{flex-direction:column}
}
  body{
  margin:0;
  font-family:Tahoma, Arial;
  background:#f4f6f8;
}

.container{
  max-width:1100px;
  width:95%;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}

/* ===== اللوجوهات ===== */
.logos{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:30px;
  margin-bottom:15px;
}

.logos img{
  height:90px;
  object-fit:contain;
}

/* ===== عنوان الفورم ===== */
.form-title{
  text-align:center;
  font-size:24px;
  color:#222;
  font-weight:bold;
  margin-bottom:30px;
}

.form-title::after{
  content:"";
  display:block;
  width:120px;
  height:3px;
  background:#0066cc;
  margin:10px auto 0;
}

/* ===== استجابة الموبايل ===== */
@media (max-width: 768px){
  .logos{
    gap:10px;
  }

  .logos img{
    height:60px;
  }

  .form-title{
    font-size:18px;
  }
}
</style>
</head>

<body>
<div class="container">
  <div class="logos">
    <img src="logo-right.png" alt="logo right">
    <img src="logo-left.png" alt="logo left">
  </div>

  <h1 class="form-title">
    إستمارة تسجيل بيانات المتقدمين لمسابقة الندب رقم ١ لسنة ٢٠٢٦
  </h1>
  <form id="dataForm">
<!-- ================= البيانات الشخصية ================= -->
<h2>البيانات الشخصية</h2>
<div class="form-row">
  <input id="fullName" placeholder="الاسم بالكامل" required>
  <input id="nationalId" placeholder="الرقم القومي" maxlength="14" required>
</div>
<div class="form-row">
  <input id="mobile" placeholder="رقم الموبايل" maxlength="11" required>
  <input type="text" id="birthDate" placeholder="تاريخ الميلاد"
   onfocus="this.type='date'" onblur="if(!this.value)this.type='text'" required>
  <select id="gender" required>
    <option value="">النوع</option>
    <option>ذكر</option>
    <option>أنثى</option>
  </select>
</div>
<div class="form-row">
  <input id="address" placeholder="العنوان" required>
</div>

<!-- ================= البيانات الدراسية ================= -->
<h2>البيانات الدراسية</h2>
<div class="form-row">
  <select id="qualification" required>
    <option value="">المؤهل</option>
    <option>ليسانس حقوق/ليسانس شريعة وقانون (تخصص قانون)</option>
    <option>بكالوريوس تجارة</option>
    <option>مؤهل عالى </option>
    <option>بكالوريوس الهندسة (تخصص: مدنى/عمارة/كهرباء/ميكانيكا)</option>
    <option>بكالوريوس الهندسة(حاسبات)/بكالوريوس حاسبات ومعلومات</option>
    <option>بكالوريوس علوم (تخصص فيزياء)</option>
    <option>مؤهل متوسط</option>
    <option>مؤهل أقل من متوسط</option>
  </select>
  <input id="university" placeholder="الجامعة / المعهد" required>
</div>
<div class="form-row">
  <input id="college" placeholder="الكلية">
  <select id="grade" required>
    <option value="">التقدير</option>
    <option>إمتياز</option>
    <option>جيد جداً</option>
    <option>جيد</option>
    <option>مقبول</option>
  </select>
</div>

<!-- ================= البيانات الوظيفية ================= -->
<h2>البيانات الوظيفية</h2>
<div class="form-row">
  <input id="workPlace" placeholder="جهة العمل" required>
  <input type="text" id="hireDate" placeholder="تاريخ التعيين"
   onfocus="this.type='date'" onblur="if(!this.value)this.type='text'" required>
</div>

<div class="form-row">
  <select id="level" required>
    <option value="">المستوى الوظيفي</option>
    <option value="للوظائف التخصصية">للوظائف التخصصية</option>
    <option value="للوظائف الكتابية والفنية">للوظائف الكتابية والفنية</option>
    <option value="للوظائف الحرفية والخدمة المعاونة">للوظائف الحرفية والخدمة المعاونة</option>
  </select>

  <select id="jobGrade" required>
    <option value="">الدرجة الوظيفية</option>
  </select>
</div>

<div class="form-row">
  <select id="jobGroupType" required>
    <option value="">المجموعة النوعية</option>
    <option value="لوظائف القانون">لوظائف القانون</option>
    <option value="التمويل والمحاسبة">التمويل والمحاسبة</option>
    <option value="التنمية الإدارية">التنمية الإدارية</option>
    <option value="الهندسة">الهندسة</option>
    <option value="العلوم">العلوم</option>
    <option value="الوظائف الكتابية">الوظائف الكتابية</option>
    <option value="الحركة والنقل">الحركة والنقل</option>
    <option value="الخدمات المعاونة">الخدمات المعاونة</option>
    <option value="الأمن">الأمن</option>
  </select>

  <select id="jobGroup" required>
    <option value="">المجموعة الوظيفية</option>
  </select>
</div>

<div class="form-row">
  <input id="currentJob" placeholder="الوظيفة الحالية" required>
<select id="appliedJob"  placeholder="الوظيفة المتقدم إليها" required>
    <option value="">الوظيفة المتقدم إليها</option>
    <option>قانون</option>
    <option>محاسبة/مراجعة/تخصص جمارك</option>
     <option>الموارد البشرية/التطوير المؤسسىى(التنظيم)/إدارة وتنمية المواهب(التدريب)/الأستحقاقات والمزايا/تخطيط التدريب</option>
     <option>العمل بجمرك مطار القاهرة</option>
     <option>تنفيذ المنشأت/صيانة</option>
     <option>إدارة أجهزة البنية التحتية/إدارة الأجهزة والتشغيل والصيانة/قواعد البيانات</option>
     <option>أجهزة الفحص بالأشعة</option>
     <option>أعمال كتابية</option>
     <option>سائقين</option>
     <option>عمالة</option>
     <option>الأمن</option>
  </select></div>

<!-- ================= الدورات التدريبية ================= -->
<h2>الدورات التدريبية</h2>
<div id="coursesContainer"></div>
<button type="button" class="add-course" onclick="addCourse()">+ إضافة دورة</button>

<label style="display:block;margin-top:20px">
<input type="checkbox" required>  أقر بأن جميع البيانات صحيحة وأتحمل كامل المسئولية
</label><br>

<div id="messageBox" class="hidden"></div>
<button class="submit-btn">حفظ البيانات</button>

</form>
</div>

<script>
const scriptURL="https://script.google.com/macros/s/AKfycbxIqm8szUYq-M6SZI-AbwU7tfJTOwympIm-cjBk0RzthOIatl4hNSHo5-_twDKh1Gp7Rg/exec";

/* ================= الدورات ================= */
function addCourse(){
  const div=document.createElement("div");
  div.className="course-row";
  div.innerHTML=`
    <div class="course-line">
      <input placeholder="اسم الدورة">
      <input placeholder="مكان الدورة">
    </div>
    <div class="course-line">
      <input placeholder="مدة الدورة">
      <input type="date">
    </div>
    <button type="button" class="remove-course"
      onclick="this.parentElement.remove()">حذف</button>`;
  coursesContainer.appendChild(div);
}

/* ================= المجموعات ================= */
const jobGroupsData={
 "لوظائف القانون":["قانون"],
 "التمويل والمحاسبة":["محاسبة","مراجعة","تخصص جمارك"],
 "التنمية الإدارية":["موارد بشرية","التنمية الإدارية"],
 "الهندسة":["تنفيذ المنشآت","صيانة"],
 "العلوم":["أجهزة الفحص بالأشعة"],
 "الوظائف الكتابية":["أعمال كتابية"],
 "الحركة والنقل":["سائقين"],
 "الخدمات المعاونة":["عمالة"],
 "الأمن":["الأمن"]
};

jobGroupType.addEventListener("change",()=>{
 jobGroup.innerHTML='<option value="">المجموعة الوظيفية</option>';
 (jobGroupsData[jobGroupType.value]||[]).forEach(v=>{
  jobGroup.innerHTML+=`<option value="${v}">${v}</option>`;
 });
});

/* ================= الدرجات ================= */
const gradesData={
 "للوظائف التخصصية":["الأولى","الثانية","الثالثة"],
 "للوظائف الكتابية والفنية":["الثانية","الثالثة","الرابعة"],
 "للوظائف الحرفية والخدمة المعاونة":["الثالثة","الرابعة","الخامسة","السادسة"]
};

level.addEventListener("change",()=>{
 jobGrade.innerHTML='<option value="">الدرجة الوظيفية</option>';
 (gradesData[level.value]||[]).forEach(g=>{
  jobGrade.innerHTML+=`<option value="${g}">${g}</option>`;
 });
});

/* ================= الحفظ ================= */
dataForm.addEventListener("submit",e=>{
 e.preventDefault();

 if(!/^\d{11}$/.test(mobile.value)){
  alert("رقم الموبايل يجب أن يكون 11 رقم");
  return;
 }

 const courses=[];
 document.querySelectorAll(".course-row").forEach(r=>{
  const i=r.querySelectorAll("input");
  courses.push({
   name:i[0].value,
   place:i[1].value,
   duration:i[2].value,
   date:i[3].value
  });
 });

 messageBox.className="hidden";

 fetch(scriptURL,{
  method:"POST",
  body:JSON.stringify({
   fullName:fullName.value,
   nationalId:nationalId.value,
   mobile:mobile.value,
   birthDate:birthDate.value,
   gender:gender.value,
   address:address.value,
   qualification:qualification.value,
   university:university.value,
   college:college.value,
   grade:grade.value,
   workPlace:workPlace.value,
   hireDate:hireDate.value,
   level:level.value,
   jobGrade:jobGrade.value,
   jobGroupType:jobGroupType.value,
   jobGroup:jobGroup.value,
   currentJob:currentJob.value,
   appliedJob:appliedJob.value,
   courses:courses
  })
 })
 .then(r=>r.text())
 .then(t=>{
  if(t==="EXISTS"){
   messageBox.className="error";
   messageBox.innerText="❌ الرقم القومي مسجل من قبل";
  }else{
   messageBox.className="success";
   messageBox.innerText="✅ تم حفظ البيانات بنجاح";
   dataForm.reset();
   coursesContainer.innerHTML="";
  }
  messageBox.classList.remove("hidden");
 })
 .catch(()=>{
  messageBox.className="error";
  messageBox.innerText="⚠️ حدث خطأ أثناء الحفظ";
  messageBox.classList.remove("hidden");
 });
});
</script>

</body>
</html>
