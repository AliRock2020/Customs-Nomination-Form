<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>تسجيل بيانات المتقدم </title>

<style>
body{
  font-family: Tahoma, Arial;
  background:#f5f5f5;
  margin:0;
}

.container{
  max-width:1000px;
  margin:auto;
  background:#fff;
  padding:25px;
}

.logos{
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
}

.logos img{
  height:90px;
}

h2{
  text-align:center;
  margin-bottom:25px;
}

.form-row{
  display:flex;
  gap:15px;
  margin-bottom:15px;
}

.form-row input,
.form-row select{
  flex:1;
  padding:10px;
  font-size:14px;
}

.full-width{
  width:100%;
  margin-bottom:15px;
  padding:10px;
}

.courses{
  border:1px solid #ccc;
  padding:15px;
  margin-top:20px;
}

.course-row{
  display:flex;
  gap:10px;
  margin-bottom:10px;
}

button{
  padding:12px 20px;
  font-size:15px;
  cursor:pointer;
}

.add-course{
  background:#eee;
  border:1px dashed #999;
}

.submit-btn{
  background:#0066cc;
  color:#fff;
  border:none;
  width:100%;
  margin-top:20px;
}
</style>
</head>

<body>

<div class="container">

<div class="logos">
  <img src="logo-right.png">
  <img src="logo-left.png">
</div>
<h2>إستمارة تسجيل البيانات لمسابقة الندب لمصلحة الجمارك المصرية</h2>

<form id="dataForm">
<div class="personalData">
  <h3>البيانات الشخصية</h3>
<div class="form-row">
  <input id="fullName" placeholder="الاسم بالكامل" required>
  <input id="nationalId" placeholder="الرقم القومي" maxlength="14" required>
</div>
<div class="form-row">
  <input id="mobile" placeholder="رقم الموبايل" maxlength="11" required>
  <label>تاريخ الميلاد</label><input id="birthDate" type="date" required>
  <select id="gender" required>
    <option value="">النوع</option>
    <option>ذكر</option>
    <option>أنثى</option>
  </select>
</div>
<div class="form-row">
       <input id="adress" placeholder="العنوان" required>
  </div>
</div>
  
<div class="studyData">
  <h3>البيانات الجامعية</h3>
<div class="form-row">
  <input id="university" placeholder="الجامعة" required>
  <input id="college" placeholder="الكلية" required>
</div>
<div class="form-row">
    <input id="qualification" placeholder="المؤهل الجامعي" required>
  <input id="grade" placeholder="التقدير العام" required>
  </div>
</div>
  
  <div class="jobData">
  <h3>البيانات الوظيفية</h3>
<div class="form-row">
    <input id="workPlace" placeholder="جهة العمل" required>
    <input id="level" placeholder="المستوى الوظيفي" required>
    <label>تاريخ التعيين</label><input id="hireDate" type="date" required>
</div>
<div class="form-row">
  <input id="currentJob" placeholder="الوظيفة الحالية" required>
  <input id="appliedJob" placeholder="الوظيفة المتقدم لها" required>
</div>
  </div>

<div class="courses">
<h3>الدورات التدريبية</h3>
<div id="coursesContainer"></div>

<button type="button" class="add-course" onclick="addCourse()">+ إضافة دورة</button>
</div>

  <div style="margin-top:20px">
    <label>
        <input type="checkbox">  أقر بأن جميع البيانات صحيحة وأتحمل المسئولية القانونية <required>
       .
    </label>
</div>
  
<button type="submit" class="submit-btn">حفظ البيانات</button>

</form>
</div>

<script>
const scriptURL = "PUT_WEB_APP_URL_HERE";

function addCourse(){
  const div = document.createElement("div");
  div.className="course-row";
  div.innerHTML=`
    <input placeholder="اسم الدورة">
    <input placeholder="مكان الدورة">
    <input placeholder="المدة">
    <input type="date">
  `;
  document.getElementById("coursesContainer").appendChild(div);
}

document.getElementById("dataForm").addEventListener("submit", e=>{
  e.preventDefault();

  const mobile = document.getElementById("mobile").value;
  if(!/^\d{11}$/.test(mobile)){
    alert("رقم الموبايل يجب أن يكون 11 رقم");
    return;
  }

  const courses=[];
  document.querySelectorAll(".course-row").forEach(row=>{
    const inputs=row.querySelectorAll("input");
    courses.push({
      name:inputs[0].value,
      place:inputs[1].value,
      duration:inputs[2].value,
      date:inputs[3].value
    });
  });

  const data={
    nationalId:nationalId.value,
    mobile:mobile,
    fullName:fullName.value,
    birthDate:birthDate.value,
    gender:gender.value,
    workPlace:workPlace.value,
    currentJob:currentJob.value,
    hireDate:hireDate.value,
    university:university.value,
    college:college.value,
    qualification:qualification.value,
    grade:grade.value,
    level:level.value,
    appliedJob:appliedJob.value,
    courses:courses
  };

  fetch(scriptURL,{
    method:"POST",
    body:JSON.stringify(data)
  })
  .then(r=>r.text())
  .then(t=>{
    if(t==="EXISTS"){
      alert("الرقم القومي مسجل من قبل");
    }else{
      document.getElementById("dataForm").reset();
      document.getElementById("coursesContainer").innerHTML="";
    }
  });
});
</script>

</body>
</html>
